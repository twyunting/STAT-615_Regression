---
title: "Lab 12"
author: "Yunting Chiu"
date: "`r Sys.Date()`"
output: pdf_document
urlcolor: blue
linkcolor: red
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```
# Install the data
```{r}
mtcars %>%
  head() %>%
  select(mpg, hp, am)
```
We will focus on three variables: `mpg`, `hp`, `am`
```{r}
mtcars %>%
  ggplot(aes(x = hp, y = mpg)) +
  geom_point(shape = 21, size = .1, stroke = 2)
```

We could also label the points based on the transmission type `am`
- `am` is a dummy variable:
  + 0 for automatic transmissions
  + 1 for manual transmissions
```{r}
mtcars %>%
  ggplot(aes(x = hp, y = mpg, col = as.factor(am))) +
  geom_point(shape = 21, size = .1, stroke = 2) +
   scale_color_manual(name="transmissions",
                       labels=c("automatic","manual"),
                       values=c("red","blue")) +
  theme_bw()
```

# simple linear regression
$$
Y = \beta0 + \beta1X1 + ei
$$
```{r}
mpg_hp_slr = lm(mpg ~ hp, data = mtcars)
summary(mpg_hp_slr)
```

# Add the fitted line to the plot
```{r}
mtcars %>%
  ggplot(aes(x = hp, y = mpg, col = as.factor(am))) +
  # geom_smooth(method='lm', formula = y~x, se = FALSE) +
    geom_point(shape = 21, size = .1, stroke = 2) +
   scale_color_manual(name="transmissions",
                       labels=c("automatic","manual"),
                       values=c("red","blue")) +
  theme_bw() +
  geom_abline(aes(intercept = 30.09886, slope = -0.06823))
```

Obviously, the red points are below the line, meaning that the model underestimates the fuel efficiency of manual transmission. On the other hand, the blue points are above the line, meaning that the model overestimates the fuel efficiency of automatic transmission. Thus, we need to constantly adjust the model.

# Multiple regression model
$$
Y = \beta0 + \beta1X1 + \beta2X2 + ei
$$